$servers = @("Server1", "Server2", "Server3") # Replace with your array of server names

foreach ($server in $servers) {
    Write-Host "Checking VC++ Redistributable versions on $server..."
    $scriptBlock = {
        $regPath = "SOFTWARE\Microsoft\VisualStudio"
        $versions = @()

        try {
            $subKey = Get-ItemProperty "HKLM:\$regPath"
            foreach ($keyName in $subKey.GetSubKeyNames()) {
                if ($keyName.StartsWith("VC")) {
                    $key = Get-ItemProperty "HKLM:\$regPath\$keyName"
                    $version = $key.Version
                    $versions += "$keyName $version"
                }
            }

            if ($versions) {
                Write-Host "VC++ Redistributable versions found on $($env:COMPUTERNAME):"
                foreach ($version in $versions) {
                    Write-Host "- $version"
                }
            }
            else {
                Write-Host "No VC++ Redistributable versions found on $($env:COMPUTERNAME)."
            }
        }
        catch {
            Write-Host "Error checking VC++ Redistributable versions on $($env:COMPUTERNAME): $_"
        }
    }

    Invoke-Command -ComputerName $server -ScriptBlock $scriptBlock
}
