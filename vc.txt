$servers = @("Server1", "Server2", "Server3") # Replace with your array of server names

$output = foreach ($server in $servers) {
    Write-Host "Checking VC++ Redistributable versions on $server..."
    $scriptBlock = {
        try {
            $versions = Get-WmiObject -Class Win32_Product | Where-Object {$_.Name -like "Microsoft Visual C++ Redistributable*"} | Select-Object -Property Name, Version

            if ($versions) {
                foreach ($version in $versions) {
                    [PSCustomObject]@{
                        Server = $env:COMPUTERNAME
                        Name = $version.Name
                        Version = $version.Version
                    }
                }
            }
            else {
                [PSCustomObject]@{
                    Server = $env:COMPUTERNAME
                    Name = "No VC++ Redistributable versions found"
                    Version = ""
                }
            }
        }
        catch {
            [PSCustomObject]@{
                Server = $env:COMPUTERNAME
                Name = "Error checking VC++ Redistributable versions"
                Version = $_.Exception.Message
            }
        }
    }

    Invoke-Command -ComputerName $server -ScriptBlock $scriptBlock
}

$output | Format-Table -AutoSize
