# Set the registry paths for TLS settings and Microsoft cryptography ciphers
$tlsPath = "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols"
$ciphersPath = "HKLM:\SOFTWARE\Microsoft\Cryptography\Configuration\SSL\00010002"

# Retrieve the TLS settings from the registry
$tlsSettings = Get-ChildItem -Path $tlsPath -Recurse |
    Where-Object { $_.Name -notmatch "DisabledByDefault|Client|Server" } |
    ForEach-Object {
        $protocol = $_.PSChildName
        $enabled = (Get-ItemProperty -Path "$tlsPath\$protocol" -ErrorAction SilentlyContinue).Enabled
        $sslSetting = (Get-ItemProperty -Path "$tlsPath\$protocol\SSL 3.0" -ErrorAction SilentlyContinue).Enabled
        $strongCryptoSetting = (Get-ItemProperty -Path "$tlsPath\$protocol\CipherSuites\*\RC4 128/128" -ErrorAction SilentlyContinue).Enabled

        [PSCustomObject]@{
            Protocol = $protocol
            Enabled = if ($enabled) { $enabled } else { "N/A" }
            SSLEnabled = if ($sslSetting) { $sslSetting } else { "N/A" }
            SchUseStrongCrypto = if ($strongCryptoSetting) { $strongCryptoSetting } else { "N/A" }
        }
    }

# Retrieve the Microsoft cryptography cipher settings from the registry
$cipherSettings = Get-ItemProperty -Path $ciphersPath -ErrorAction SilentlyContinue |
    Select-Object -Property PSChildName, Enabled

# Display the TLS, SSL, SchUseStrongCrypto, and Microsoft cryptography cipher settings in a table
$tlsSettings | Format-Table -AutoSize
Write-Host "`nMicrosoft Cryptography Ciphers:`n"
$cipherSettings | Format-Table -AutoSize
