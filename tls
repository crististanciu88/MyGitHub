# Set the registry paths for TLS settings, Microsoft cryptography ciphers, SchUseStrongCrypto, and DefaultTLS
$tlsPath = "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols"
$ciphersPath = "HKLM:\SOFTWARE\Microsoft\Cryptography\Configuration\Local\SSL\00010002"
$ciphersPathAlt = "HKLM:\SOFTWARE\Microsoft\Cryptography\Configuration\Local\SSL\00010003"
$schUseStrongCryptoPath = "HKLM:\SOFTWARE\Wow6432Node\Microsoft\.NETFramework\v4.0.30319"
$defaultTlsPath = "$schUseStrongCryptoPath\SystemDefaultTlsVersions"

# Retrieve the TLS settings from the registry
$tlsSettings = Get-ChildItem -Path $tlsPath -Recurse |
    Where-Object { $_.Name -notmatch "DisabledByDefault|Client|Server" } |
    ForEach-Object {
        $protocol = $_.PSChildName
        $enabled = (Get-ItemProperty -Path "$tlsPath\$protocol" -ErrorAction SilentlyContinue).Enabled
        $sslSetting = (Get-ItemProperty -Path "$tlsPath\$protocol\SSL 3.0" -ErrorAction SilentlyContinue).Enabled
        $strongCryptoSetting = (Get-ItemProperty -Path "$tlsPath\$protocol\CipherSuites\*\RC4 128/128" -ErrorAction SilentlyContinue).Enabled

        [PSCustomObject]@{
            Protocol = $protocol
            Enabled = if ($enabled) { $enabled } else { "N/A" }
            SSLEnabled = if ($sslSetting) { $sslSetting } else { "N/A" }
            SchUseStrongCrypto = if ($strongCryptoSetting) { $strongCryptoSetting } else { "N/A" }
        }
    }

# Retrieve the Microsoft cryptography cipher settings from the registry
$cipherSettings = Get-ItemProperty -Path $ciphersPath -ErrorAction SilentlyContinue |
    Select-Object -Property PSChildName, Enabled
$cipherSettingsAlt = Get-ItemProperty -Path $ciphersPathAlt -ErrorAction SilentlyContinue |
    Select-Object -Property PSChildName, Enabled

# Retrieve the SchUseStrongCrypto setting from the registry
$schUseStrongCrypto = (Get-ItemProperty -Path $schUseStrongCryptoPath -Name "SchUseStrongCrypto" -ErrorAction SilentlyContinue)."SchUseStrongCrypto"

# Retrieve the DefaultTLS setting from the registry
$defaultTls = (Get-ItemProperty -Path $defaultTlsPath -Name "SchUseStrongCrypto" -ErrorAction SilentlyContinue)."SystemDefaultTlsVersions"

# Display the TLS, SSL, SchUseStrongCrypto, and Microsoft cryptography cipher settings in a table
$tlsSettings | Format-Table -AutoSize
Write-Host "`nMicrosoft Cryptography Ciphers (00010002):`n"
$cipherSettings | Format-Table -AutoSize
Write-Host "`nMicrosoft Cryptography Ciphers (00010003):`n"
$cipherSettingsAlt | Format-Table -AutoSize
Write-Host "`nSchUseStrongCrypto:`n$schUseStrongCrypto"
Write-Host "`nDefaultTLS:`n$defaultTls"
