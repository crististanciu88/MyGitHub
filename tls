# Set the registry path for TLS settings
$tlsPath = "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols"

# Retrieve the TLS, SSL, and SchUseStrongCrypto settings from the registry
$tlsSettings = Get-ChildItem -Path $tlsPath -Recurse |
    Where-Object { $_.Name -notmatch "DisabledByDefault|Client|Server" } |
    ForEach-Object {
        $protocol = $_.PSChildName
        $enabled = (Get-ItemProperty -Path "$tlsPath\$protocol" -ErrorAction SilentlyContinue)?.Enabled
        $sslSetting = (Get-ItemProperty -Path "$tlsPath\$protocol\SSL 3.0" -ErrorAction SilentlyContinue)?.Enabled
        $strongCryptoSetting = (Get-ItemProperty -Path "$tlsPath\$protocol\CipherSuites\*\RC4 128/128" -ErrorAction SilentlyContinue)?.Enabled

        [PSCustomObject]@{
            Protocol = $protocol
            Enabled = $enabled ?? "N/A"
            SSLEnabled = $sslSetting ?? "N/A"
            SchUseStrongCrypto = $strongCryptoSetting ?? "N/A"
        }
    }

# Display the TLS, SSL, and SchUseStrongCrypto settings in a table
$tlsSettings | Format-Table -AutoSize
