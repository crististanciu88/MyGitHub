# Define GitLab API URL and access token
$GitLabUrl = "https://gitlab.example.com/api/v4"
$AccessToken = "YOUR_PERSONAL_ACCESS_TOKEN"

# Define group path (replace with your group's path)
$GroupPath = "your-group"

# Get group ID
$Group = Invoke-RestMethod -Uri "$GitLabUrl/groups/$GroupPath?private_token=$AccessToken" -Method Get
$GroupId = $Group.id

# Get projects in the group
$Projects = Invoke-RestMethod -Uri "$GitLabUrl/groups/$GroupId/projects?private_token=$AccessToken&per_page=100" -Method Get

# Iterate through each project
foreach ($Project in $Projects) {
    $ProjectId = $Project.id
    $ProjectName = $Project.name

    # Get last commit date for the project
    $Commits = Invoke-RestMethod -Uri "$GitLabUrl/projects/$ProjectId/repository/commits?private_token=$AccessToken&per_page=1" -Method Get
    if ($Commits.Count -gt 0) {
        $LastCommitDate = $Commits[0].committed_date
    } else {
        $LastCommitDate = "No commits found"
    }

    Write-Host "Project: $ProjectName, Last Commit Date: $LastCommitDate"
}
