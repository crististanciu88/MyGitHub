param (
    [string]$appPoolName,
    [string]$outputXmlPath
)

# Get the application pool settings
$appPool = Get-Item "IIS:\AppPools\$appPoolName"
$appPoolSettings = $appPool | Get-ItemProperty

# Select specific properties for export
$selectedProperties = @{
    'Name' = $appPoolName
    'ManagedPipelineMode' = $appPoolSettings.ManagedPipelineMode
    'Enable32BitAppOnWin64' = $appPoolSettings.Enable32BitAppOnWin64
    'ProcessModel' = $appPoolSettings.ProcessModel
    'Recycling' = $appPoolSettings.Recycling
    'AutoStart' = $appPoolSettings.AutoStart
}

# Export the selected properties to a Clixml file
$selectedProperties | Export-Clixml -Path $outputXmlPath

Write-Host "AppPool settings exported to: $outputXmlPath"
