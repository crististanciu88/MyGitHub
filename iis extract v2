param (
    [string]$appPoolName,
    [string]$outputXmlPath
)

# Get the application pool settings
$appPool = Get-Item "IIS:\AppPools\$appPoolName"
$appPoolSettings = $appPool | Get-ItemProperty

# Create a custom object to store the settings
$appPoolObject = [PSCustomObject]@{
    Name = $appPoolName
}

# Add application pool settings to the custom object
foreach ($setting in $appPoolSettings.PSObject.Properties) {
    $appPoolObject | Add-Member -MemberType NoteProperty -Name $setting.Name -Value $setting.Value
}

# Export the custom object to a Clixml file
$appPoolObject | Export-Clixml -Path $outputXmlPath

Write-Host "AppPool settings exported to: $outputXmlPath"
