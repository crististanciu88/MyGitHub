param (
    [string]$appPoolName,
    [string]$outputJsonPath
)

# Get the application pool settings
$appPool = Get-Item "IIS:\AppPools\$appPoolName"
$appPoolSettings = $appPool | Get-ItemProperty

# Select specific properties for export
$selectedProperties = @{
    'Name' = $appPoolName
    'ManagedPipelineMode' = $appPoolSettings.ManagedPipelineMode
    'Enable32BitAppOnWin64' = $appPoolSettings.Enable32BitAppOnWin64
    'ProcessModel' = $appPoolSettings.ProcessModel
    'Recycling' = $appPoolSettings.Recycling
    'AutoStart' = $appPoolSettings.AutoStart
}

# Convert selected properties to JSON format
$jsonOutput = $selectedProperties | ConvertTo-Json

# Export the JSON to a file
$jsonOutput | Out-File -FilePath $outputJsonPath -Encoding UTF8

Write-Host "AppPool settings exported to: $outputJsonPath"
