function Get-DotNetFrameworkVersion {
    [CmdletBinding()]
    param (
        [Parameter(Mandatory=$true)]
        [string[]]$ServerList
    )

    foreach ($Server in $ServerList) {
        Write-Host "Server: $Server"
        try {
            $DotNetVersion = Get-WmiObject -Class Win32_Product -ComputerName $Server -Filter "Name like 'Microsoft .NET%'" | Select-Object -First 1 -ExpandProperty Version
            if ($DotNetVersion) {
                Write-Host ".NET Framework Version: $DotNetVersion"
            } else {
                Write-Host ".NET Framework not found on $Server"
            }
        } catch {
            Write-Host "Error occurred while querying $Server: $_"
        }
        Write-Host ""
    }
}
