param (
    [string]$appPoolName,
    [string]$outputXmlPath
)

# Create an XML document
$xmlDoc = New-Object System.Xml.XmlDocument

# Create the root element
$rootNode = $xmlDoc.CreateElement("AppPoolSettings")
$xmlDoc.AppendChild($rootNode)

# Get the application pool settings
$appPool = Get-Item "IIS:\AppPools\$appPoolName"
$appPoolSettings = $appPool | Get-ItemProperty

# Create an element for the application pool settings
$appPoolNode = $xmlDoc.CreateElement("AppPool")
$xmlDoc.SelectSingleNode("//AppPoolSettings").AppendChild($appPoolNode)

# Add application pool settings to the XML
foreach ($setting in $appPoolSettings.PSObject.Properties) {
    $settingNode = $xmlDoc.CreateElement($setting.Name)
    $settingNode.InnerText = $setting.Value
    $appPoolNode.AppendChild($settingNode)
}

# Save the XML to the specified location
$xmlDoc.Save($outputXmlPath)

Write-Host "AppPool settings exported to: $outputXmlPath"
